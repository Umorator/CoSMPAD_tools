# CoSMPAD Tools

A comprehensive pipeline for feature extraction and prediction of microbial secretory preproteins.  
This repository supports reproducible inference of secretion pathway classes from protein sequences as part of the work:

**CoSMPAD: Comparative Secretory Microbial Preprotein Activity Database**

---

Overview

This pipeline processes microbial protein sequences through several stages:

Sequence Preprocessing: Cleaning and validation of raw protein sequences

Feature Extraction: Classical physicochemical descriptors and ESM-2 embeddings

Model Inference: Ensemble prediction using trained XGBoost classifiers

Probability Estimation: Per-class confidence scores for secretion pathways

Programmatic Access: Python API for batch or single-sequence prediction

---

Supported Prediction Classes

Sec/SPI  
Sec/SPII (Lipoproteins)  
Sec/SPIII (Pilin-like)  
Tat/SPI  
Tat/SPII  
TM / Globular (No signal peptide)

---

Quick Start

Set up environment:

# bash
pip install .

Run predictions from Python:

# python
from cosmpad_predictor.api import CosmpadPredictor

predictor = CosmpadPredictor()

sequences = [
    "MKKKKTIIALSYIFCLVFADYKDDDDK",
    "MPLNVSFTL..."
]

results = predictor.predict_from_sequence(sequences)

for r in results:
    print(r)

---

Example Output

# python
{
  'sequence': 'MKKKKTIIALSYIFCLVFADYKDDDDK',
  'pred_label_name': 'Sec/SPI',
  'pred_proba': {
      'TM/Globular': 0.03,
      'Sec/SPI': 0.96,
      'Sec/SPII': 0.03,
      'Sec/SPIIII': 0.00,
      'Tat/SPI': 0.00,
      'Tat/SPII': 0.00
  }
}

---

Pipeline Stages

1. Sequence Preprocessing

Input protein sequences are cleaned and validated:

Removal of invalid characters

Uppercase normalization

Minimum length checks

---

2. Feature Extraction

Each sequence is transformed into a fixed-length numerical representation using:

ESM-2 protein language model embeddings

Peptides physicochemical descriptors

BioPython protein properties

ProPy sequence descriptors

Feature ordering strictly matches the configuration used during model training.

---

3. Model Inference

Predictions are generated using:

An ensemble of XGBoost classifiers

Cross-validation-trained folds

Mean probability aggregation across models

---

4. Probability Estimation

For each sequence, the model returns:

The predicted secretion class

A probability score for each possible class

Probabilities are rounded for interpretability.

---

5. Programmatic Access

All functionality is exposed via a Python API:

Single-sequence prediction

Batch prediction

Dictionary-based outputs for easy downstream analysis

---

Directory Structure

# text
CoSMPAD_tools/
├── cosmpad_predictor/
│   ├── api.py
│   ├── esm_model.py
│   ├── features.py
│   ├── models/
│   │   ├── model_fold_1.pkl
│   │   ├── model_fold_2.pkl
│   │   ├── model_fold_3.pkl
│   │   ├── trained_feature_order.pkl
│   │   └── label_encoders.pkl
│   └── __init__.py
├── pyproject.toml
├── README.md
├── LICENSE
└── MANIFEST.in

---

Citation

If you use CoSMPAD Tools in your research, please cite:

Rafael Moran-Torres  
PhD work in progress  
CoSMPAD: Comparative Secretory Microbial Preprotein Activity Database

---

License

This project is released under the MIT License.  
See the LICENSE file for details.
